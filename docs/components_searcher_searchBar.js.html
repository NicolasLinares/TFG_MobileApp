<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/searcher/searchBar.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/searcher/searchBar.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
* @fileoverview Buscador por nombre de nota de voz
*
* @version 1
* @author Nicolás Linares La Barba &lt;nlbarba97@gmail.com>
*/


import React, { Component } from 'react';
import {
    Platform,
} from 'react-native';
import { SearchBar } from 'react-native-elements';

import { httpService, checkInputService } from '_services';

import { connect } from 'react-redux';
import { setHistory, cleanHistory} from '_redux_actions';
import { COLORS } from '_styles';


class Search extends Component {

    constructor(props) {
        super(props);
        this.state = {
            searchText: '',
            showNullResponse: false,
            loading: false,
        }
    }

    async searchWord() {
        if (this.state.searchText != '')
            if (!checkInputService.withBlankSpaces(this.state.searchText)) {
                
                this.setState({ loading: true });

                // Se borra de la base de datos del servidor
                let response = await httpService.searchAudio(this.state.searchText);
                if (response !== null &amp;&amp; response.data.length > 0) {
                    this.setState({ showNullResponse: false, loading: false });

                    // Se vacía el historial de audios grabados 
                    // para que no se dupliquen en caso de haber 
                    // hecho la consulta antes        
                    this.props.cleanHistory();
                    this.props.setNextURL(response.next_page_url)

                    let list = response.data;
                    N = list.length;
                    for (let i = 0; i &lt; N; i++) {
                        // Se añade cada audio al historial de audios 
                        // grabados por el médico
                        this.props.setHistory(list[i]);
                    }

                } else {
                    this.setState({ showNullResponse: true, loading: false });
                }
            } else {
                this.setState({ showNullResponse: true, loading: false });
            }
    }

    onChangeText = (value) => {
        this.setState({ searchText: value });
    }

    render() {
        return (
            &lt;SearchBar
                platform={Platform.OS}
                lightTheme
                containerStyle={{ width: Platform.OS === 'ios' ? '90%' : '85%', alignSelf: 'center' }}
                inputContainerStyle={{ backgroundColor: this.state.showNullResponse ? 'rgba(255,0,0,0.3)' : COLORS.light_grey, borderRadius: 15, height: 35 }}
                inputStyle={{fontSize: 16}}
                cancelButtonTitle={'Cancelar'}
                showLoading={this.state.loading}
                placeholder={"Buscar..."}
                onChangeText={(searchText) => this.onChangeText(searchText)}
                onBlur={() => this.searchWord()}
                onFocus={() => this.setState({ showNullResponse: false })}
                onCancel={() => {
                    this.setState({showNullResponse: false,loading: false });
                    this.props.resetHistory();
                }
                }
                onClear={() => {
                    this.setState({showNullResponse: false, loading: false });
                    this.props.resetHistory();
                }
                }
                value={this.state.searchText}
            />
        )
    }
}


const mapDispatchToProps = (dispatch) => {
    return {
        setHistory: (audio) => dispatch(setHistory(audio)),
        cleanHistory: () => dispatch(cleanHistory()),

    }
}

export default connect(null, mapDispatchToProps)(Search);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ContentMenu.html">ContentMenu</a></li><li><a href="DialogPrompt.html">DialogPrompt</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Sun Dec 27 2020 10:53:23 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
